<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Seif-Allah's Blog" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Seif-Allah's Blog" /> <title> OverTheWire - Bandit - Seif-Allah's Blog </title> <link rel="alternate" href="http://localhost:4000/Over-The-Wire-Bandit/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/Over-The-Wire-Bandit/" /> <meta name="description" content="WriteUp for Bandit Wargame. Recommended for beginners." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="OverTheWire - Bandit | Seif-Allah Homrani" /> <meta property="og:title" content="OverTheWire - Bandit | Seif-Allah Homrani" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/Over-The-Wire-Bandit/" /> <meta property="og:description" content="WriteUp for Bandit Wargame. Recommended for beginners." /> <meta property="og:image" content="http://localhost:4000/assets/images/writeups/OTW/bandit/bandit_cover_sm2.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="OverTheWire - Bandit | seifallah1" /> <meta name="twitter:url" content="http://localhost:4000/Over-The-Wire-Bandit/" /> <meta name="twitter:site" content="@seifallah1" /> <meta name="twitter:creator" content="@seifallah1" /> <meta name="twitter:description" content="WriteUp for Bandit Wargame. Recommended for beginners." /> <meta name="twitter:image" content="http://localhost:4000/assets/images/writeups/OTW/bandit/bandit_cover_sm2.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Seif-Allah's Blog" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a></div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <h1 class="header-title" itemprop="headline">OverTheWire - Bandit</h1> <div class="post-meta"> <time datetime="2020-08-14T00:00:00+01:00" itemprop="datePublished"> Aug 14, 2020 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Seif-Allah Homrani</span> </span> <time hidden datetime="" itemprop="dateModified"> Aug 14, 2020 </time> <span hidden itemprop="publisher" itemtype="Person">Seif-Allah Homrani</span> <span hidden itemprop="image">/assets/images/writeups/OTW/bandit/bandit_cover_sm2.png</span> <span hidden itemprop="mainEntityOfPage"><h3 id="basic-introduction-">Basic Introduction :</h3> <p>The <a href="https://overthewire.org/wargames/bandit/">Bandit</a> wargame is aimed at absolute beginners. It will teach the basics needed to be able to play other wargames.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <h3 id="basic-introduction-"> <a href="#basic-introduction-" class="anchor-head"></a> Basic Introduction : </h3> <p>The <a href="https://overthewire.org/wargames/bandit/">Bandit</a> wargame is aimed at absolute beginners. It will teach the basics needed to be able to play other wargames.</p> <h3 id="level-0---level-1"> <a href="#level-0---level-1" class="anchor-head"></a> Level 0 -&gt; Level 1 </h3> <p>This level aims to teach us about the <strong>ssh</strong> command, which is a program for logging into a remote machine and for executing commands on a remote machine. To log into the game, run:</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh bandit.labs.overthewire.org <span class="nt">-p</span> 2220 <span class="nt">-l</span> bandit0
</code></pre></div></div><hr /> <p>bandit0’s password is <strong>bandit0</strong>. After logging-in, run <strong>ls</strong> command which will list all the files in the current directory, you’ll find out that there’s a <em>readme</em> file that contains our password for the next level as mentioned in description, use <strong>cat</strong> command to read it.</p> <p><strong>PASSWORD LEVEL1 : boJ9jbbUNNfktd78OOpsqOltutMc3MY1</strong></p> <h3 id="level-1---level-2"> <a href="#level-1---level-2" class="anchor-head"></a> Level 1 -&gt; Level 2 </h3> <p>After logging in and executing the <strong>ls</strong> command, I found that there’s a file named “-“. I used the <strong>cat</strong> command to read it but it shows a blinking cursor, which keeps on printing what I wrote, It’s very obvious that the dash “-“ is a special charachter used to refer to the stdout, So we need to skip it by using <strong>/</strong>.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> ./-
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL2 : CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9</strong></p> <h3 id="level-2---level-3"> <a href="#level-2---level-3" class="anchor-head"></a> Level 2 -&gt; Level 3 </h3> <p>This level aims to teach us about the escape charachter and how to use it.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>spaces<span class="se">\ </span><span class="k">in</span><span class="se">\ </span>this<span class="se">\ </span>filename
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL3 : UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK</strong></p> <h3 id="level-3---level-4"> <a href="#level-3---level-4" class="anchor-head"></a> Level 3 -&gt; Level 4 </h3> <p>Hidden files are the ones that their names starts with a dot.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit3@bandit:~/inhere<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span>
total 12
drwxr-xr-x 2 root    root    4096 May  7 20:14 <span class="nb">.</span>
drwxr-xr-x 3 root    root    4096 May  7 20:14 ..
<span class="nt">-rw-r-----</span> 1 bandit4 bandit3   33 May  7 20:14 .hidden
bandit3@bandit:~/inhere<span class="nv">$ </span><span class="nb">cat</span> .hidden 
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL4 : pIwrPrtPN36QITSp3EQaw936yaFoFgAB</strong></p> <h3 id="level-4---level-5"> <a href="#level-4---level-5" class="anchor-head"></a> Level 4 -&gt; Level 5 </h3> <p>Files that their names starts with a dash can be accessed using ‘./xxxx’ Using the cat command we can identify which file is human readable : File 7</p> <p><strong>PASSWORD LEVEL 5 : koReBOKuIDDepwhWk7jZC0RTdopnAYKh</strong></p> <h3 id="level-5---level-6"> <a href="#level-5---level-6" class="anchor-head"></a> Level 5 -&gt; Level 6 </h3> <p>Using the find command to search for a file with a 1033c size and it’s not executable :</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit5@bandit:~/inhere<span class="nv">$ </span>find <span class="nb">.</span> <span class="nt">-type</span> f <span class="nt">-size</span> 1033c <span class="o">!</span> <span class="nt">-executable</span> 
./maybehere07/.file2
</code></pre></div></div> <p><strong>PASSWORD LEVEL 6 : DXjZPULLxYr17uwoI01bNLQbtFemEgo7</strong></p> <h3 id="level-6---level-7"> <a href="#level-6---level-7" class="anchor-head"></a> Level 6 -&gt; Level 7 </h3> <p>Using the information mentioned in the level description we can get the locate the file using the find command :</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit6@bandit:~<span class="nv">$ </span>find / <span class="nt">-type</span> f <span class="nt">-size</span> 33c <span class="nt">-user</span> bandit7 <span class="nt">-group</span> bandit6  2&gt;/dev/null
/var/lib/dpkg/info/bandit7.password
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 7 : HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs</strong></p> <h3 id="level-7---level-8"> <a href="#level-7---level-8" class="anchor-head"></a> Level 7 -&gt; Level 8 </h3> <p>Piping the cat output into grep and searching for <em>millionth</em> word will print the password.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit7@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt | <span class="nb">grep </span>millionth
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 8 : cvX2JJa4CFALtqS87jk27qwqGhBM9plV</strong></p> <h3 id="level-8---level-9"> <a href="#level-8---level-9" class="anchor-head"></a> Level 8 -&gt; Level 9 </h3> <p>Sorting the output using sort command and piping it into uniq command so we can get the password from the file.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit8@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-u</span>
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL9 : UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR</strong></p> <h3 id="level-9---level-10"> <a href="#level-9---level-10" class="anchor-head"></a> Level 9 -&gt; Level 10 </h3> <p>In this level I just used the <em>strings</em> command to print all human-readable strings in the file.</p> <p><strong>PASSWORD LEVEL10 : truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk</strong></p> <h3 id="level-10---level-11"> <a href="#level-10---level-11" class="anchor-head"></a> Level 10 -&gt; Level 11 </h3> <p>Using <em>base64</em> command with -d flag to get the password.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit10@bandit:~<span class="nv">$ </span><span class="nb">base64</span> <span class="nt">-d</span> data.txt 
The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL11 : IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR</strong></p> <h3 id="level-11---level-12"> <a href="#level-11---level-12" class="anchor-head"></a> Level 11 -&gt; Level 12 </h3> <p>In this level I used an external tool which is <a href="https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,55)&amp;input=RWxkZXIgd2FuZDogbHJ6emY3angwbDM3YzBpdDNhODltMGFleA">CyberChef</a> to rotate the file content and get the password.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit11@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt 
Gur cnffjbeq vf 5Gr8L4qetPEsPk8htqjhRK8XSP6x2RHh

AFTER ROT13 :

The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL12 : 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu</strong></p> <h3 id="level-12---level-13"> <a href="#level-12---level-13" class="anchor-head"></a> Level 12 -&gt; Level 13 </h3> <p>After doing a lot of decompression, here’s the password : <strong>PASSWORD LEVEL 13 : 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL</strong></p> <h3 id="level-13---level-14"> <a href="#level-13---level-14" class="anchor-head"></a> Level 13 -&gt; Level 14 </h3> <p>ssh bandit14@localhost -i sshkey.private <strong>PASSWORD LEVEL 14 : 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e</strong></p> <h3 id="level-14---level-15"> <a href="#level-14---level-15" class="anchor-head"></a> Level 14 -&gt; Level 15 </h3> <p>There’s a server running in localhost waiting for us to send the current password to it.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit14@bandit:~<span class="nv">$ </span><span class="nb">echo</span>  <span class="s1">'4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e'</span> | nc <span class="nt">-v</span> localhost 30000
localhost <span class="o">[</span>127.0.0.1] 30000 <span class="o">(</span>?<span class="o">)</span> open
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 15 : BfMYroe26WYalil77FoDi9qh59eK5xNr</strong></p> <h3 id="level-15---level-16"> <a href="#level-15---level-16" class="anchor-head"></a> Level 15 -&gt; Level 16 </h3> <blockquote> <p>OpenSSL comes with a client tool that you can use to connect to a secure server. The tool is similar to telnet or nc, in the sense that it handles the SSL/TLS layer but allows you to fully control the layer that comes next. To connect to a server, you need to supply a hostname and a port. For example:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>openssl s_client <span class="nt">-connect</span> localhost:30001
</code></pre></div> </div> <p><strong>PASSWORD LEVEL 16 : cluFn7wTiGryunymYOu4RcffSxQluehd</strong></p> </blockquote> <h3 id="level-16---level-17"> <a href="#level-16---level-17" class="anchor-head"></a> Level 16 -&gt; Level 17 </h3> <p>Doing the nmap scan using the <em>ssl-cert</em> script, we could identify which server speaks SSL, after giving it the current password, it responds with an <em>id_rsa</em>, so I save it inside a temporary directory and giving it the <em>400</em> permission and finally I used it to connect to the next level and retrieve the password ! <strong>PASSWORD LEVEL 17 : xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn</strong></p> <h3 id="level-17---level-18"> <a href="#level-17---level-18" class="anchor-head"></a> Level 17 -&gt; Level 18 </h3> <p>I’ve used the <em>diff</em> command to see the different passwords from the two files.</p> <p><strong>PASSWORDS LEVEL 18 : kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd</strong></p> <h3 id="level-18---level-19"> <a href="#level-18---level-19" class="anchor-head"></a> Level 18 -&gt; Level 19 </h3> <p>Running the command from ssh will show you the password</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh bandit18@localhost <span class="nb">cat </span>readme
</code></pre></div></div><hr /> <p><strong>PASSWORDS LEVEL 19 : IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x</strong></p> <h3 id="level-19---level-20"> <a href="#level-19---level-20" class="anchor-head"></a> Level 19 -&gt; Level 20 </h3> <p>There’s a SUID file inside home directory which is used to run commands as bandit20, so I used it to read the password.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit19@bandit:~<span class="nv">$ </span>./bandit20-do 
Run a <span class="nb">command </span>as another user.
  Example: ./bandit20-do <span class="nb">id
</span>bandit19@bandit:~<span class="nv">$ </span>./bandit20-do <span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>11019<span class="o">(</span>bandit19<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>11019<span class="o">(</span>bandit19<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>11020<span class="o">(</span>bandit20<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>11019<span class="o">(</span>bandit19<span class="o">)</span>
bandit19@bandit:~<span class="nv">$ </span>./bandit20-do <span class="nb">cat</span> /etc/bandit_pass/bandit20 
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 20 : GbKksEFF4yrVs6il55v6gwY5aVje5f0j</strong></p> <h3 id="level-20---level-21"> <a href="#level-20---level-21" class="anchor-head"></a> Level 20 -&gt; Level 21 </h3> <p>For this level, I started an <em>nc listener</em> in the localhost that sends the current password after every connection. (I used tmux to be able to run multiple terminals)</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit20@bandit:~<span class="nv">$ </span><span class="nb">echo </span>GbKksEFF4yrVs6il55v6gwY5aVje5f0j | nc <span class="nt">-nlvp</span> 1234
listening on <span class="o">[</span>any] 1234 ...
connect to <span class="o">[</span>127.0.0.1] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>127.0.0.1] 41732
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 21 : gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</strong></p> <h3 id="level-21---level-22"> <a href="#level-21---level-22" class="anchor-head"></a> Level 21 -&gt; Level 22 </h3> <p>Looking at the cron file, it’s clear that it print the password inside a temporary file every time the system reboots.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat </span>cronjob_bandit22 
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/cronjob_bandit22.sh 
<span class="c">#!/bin/bash</span>
<span class="nb">chmod </span>644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
<span class="nb">cat</span> /etc/bandit_pass/bandit22 <span class="o">&gt;</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv


</code></pre></div></div><hr /> <p>So I looked inside that temporary file to get the password :</p><hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</code></pre></div></div> <p><strong>PASSWORD LEVEL 22 : Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI</strong></p> <h3 id="level-22---level-23"> <a href="#level-22---level-23" class="anchor-head"></a> Level 22 -&gt; Level 23 </h3> <p>Same as previous level but this time the file is generated by md5sum.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/cronjob_bandit23.sh
<span class="c">#!/bin/bash</span>

<span class="nv">myname</span><span class="o">=</span><span class="si">$(</span><span class="nb">whoami</span><span class="si">)</span>
<span class="nv">mytarget</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo </span>I am user <span class="nv">$myname</span> | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1<span class="si">)</span>

<span class="nb">echo</span> <span class="s2">"Copying passwordfile /etc/bandit_pass/</span><span class="nv">$myname</span><span class="s2"> to /tmp/</span><span class="nv">$mytarget</span><span class="s2">"</span>

<span class="nb">cat</span> /etc/bandit_pass/<span class="nv">$myname</span> <span class="o">&gt;</span> /tmp/<span class="nv">$mytarget</span>
</code></pre></div></div><hr /> <p>So in order to find to find the file name I run the script locally after assigning <em>bandit23</em> to myname variable.</p><hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit22@bandit:/etc/cron.d<span class="nv">$ myname</span><span class="o">=</span>bandit23
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">echo </span>I am user <span class="nv">$myname</span> | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1
8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /tmp/8ca319486bfbbc3663ea0fbe81326349
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 23: jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</strong></p> <h3 id="level-23---level-24"> <a href="#level-23---level-24" class="anchor-head"></a> Level 23 -&gt; Level 24 </h3> <p>For this level, you have to make a simple script inside /var/spool/bandit24 directory</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span><span class="c">#/bin/bash</span>
<span class="nb">cat</span> /etc/bandit_pass/bandit24 <span class="o">&gt;</span> /tmp/txt.txt
</code></pre></div></div><hr /> <p>Then we need to make it executable using <em>chmod +x</em> after that our password will be in txt.txt file. <strong>PASSWORD LEVEL 24 : UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</strong></p> <h3 id="level-24---level-25"> <a href="#level-24---level-25" class="anchor-head"></a> Level 24 -&gt; Level 25 </h3> <p>For this level, we need a brute forcing script to find the 4-digit pincode.</p> <hr /> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
# coding: utf-8import sys
</span><span class="kn">import</span> <span class="nn">socketpincode</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">"UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ"</span><span class="k">try</span><span class="p">:</span>
    <span class="c1"># Connect to server
</span>    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">30002</span><span class="p">))</span>
    
    <span class="c1"># Print welcome message
</span>    <span class="n">welcome_msg</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">welcome_msg</span><span class="p">)</span>    <span class="c1"># Try brute-forcing
</span>    <span class="k">while</span> <span class="n">pincode</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="n">pincode_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pincode</span><span class="p">).</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">message</span><span class="o">=</span><span class="n">password</span><span class="o">+</span><span class="s">" "</span><span class="o">+</span><span class="n">pincode_string</span><span class="o">+</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span>        <span class="c1"># Send message
</span>        <span class="n">s</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">receive_msg</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>        <span class="c1"># Check result
</span>        <span class="k">if</span> <span class="s">"Wrong"</span> <span class="ow">in</span> <span class="n">receive_msg</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Wrong PINCODE: %s"</span> <span class="o">%</span> <span class="n">pincode_string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">receive_msg</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="n">pincode</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

</code></pre></div></div><hr /> <p>By making it executable and running it, we can retrieve the pincode.</p> <p><strong>PASSWORD LEVEL 25 : uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG</strong></p> <h3 id="level-25---level-26"> <a href="#level-25---level-26" class="anchor-head"></a> Level 25 -&gt; Level 26 </h3> <p>Looking at the /etc/passwd file, the Bandit26 is running /usr/bin/showtext script as a shell.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit25@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/showtext
<span class="c">#!/bin/sh</span>

<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>linux

more ~/text.txt
<span class="nb">exit </span>0
</code></pre></div></div><hr /> <p>That means that we cannot actually run any command after logging in with the private key, So we need to find a vulnerability inside the script to use it and gain a shell. As mentioned in <a href="https://www.sans.org/blog/escaping-restricted-linux-shells/">SANS Article</a>, we can use more to run vim and then get the shell. This means that we have to resize the currently used terminal window in size and make it so small to enter the more environment. Once done, hit h to open the help menu. Resize the terminal window an take a look at the possible options.</p> <p>The most interesting command here is v, which will start the editor vi at the current line. Type in :set shell=/bin/bash within vi and type in :shell then.</p> <p><strong>PASSWORD LEVEL 26 : 5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z</strong></p> <h3 id="level-26---level-27"> <a href="#level-26---level-27" class="anchor-head"></a> Level 26 -&gt; Level 27 </h3> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit26@bandit:~<span class="nv">$ </span>./bandit27-do 
Run a <span class="nb">command </span>as another user.
  Example: ./bandit27-do <span class="nb">id
</span>bandit26@bandit:~<span class="nv">$ </span>./bandit27-do <span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>11026<span class="o">(</span>bandit26<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>11026<span class="o">(</span>bandit26<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>11027<span class="o">(</span>bandit27<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>11026<span class="o">(</span>bandit26<span class="o">)</span>
bandit26@bandit:~<span class="nv">$ </span>./bandit27-do <span class="nb">cat</span> /etc/bandit_pass/bandit27
3ba3118a22e93127a4ed485be72ef5ea
</code></pre></div></div><hr /> <p>Easy. <strong>PASSWORD LEVEL 27: 3ba3118a22e93127a4ed485be72ef5ea</strong></p> <h3 id="level-27---level-28"> <a href="#level-27---level-28" class="anchor-head"></a> Level 27 -&gt; Level 28 </h3> <p>For this level we need to clone the repository inside a temporary directory.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone ssh://bandit27-git@localhost/home/bandit27-git/repo
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 28 : 0ef186ac70e04ea33b4c1853d2526fa2</strong></p> <h3 id="level-28---level-29"> <a href="#level-28---level-29" class="anchor-head"></a> Level 28 -&gt; Level 29 </h3> <p>I did the same as the previous level, but this time the password was removed from the README file, so I checked the log file and used -p flag to see the difference between the commits.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git log <span class="nt">-p</span> <span class="nt">-1</span>
commit edd935d60906b33f0619605abd1689808ccdd5ee
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Thu May 7 20:14:49 2020 +0200

    fix info leak

diff <span class="nt">--git</span> a/README.md b/README.md
index 3f7cee8..5c6457b 100644
<span class="nt">---</span> a/README.md
+++ b/README.md
@@ <span class="nt">-4</span>,5 +4,5 @@ Some notes <span class="k">for </span>level29 of bandit.
 <span class="c">## credentials</span>
 
 - username: bandit29
<span class="nt">--</span> password: bbc96594b4e001778eee9975372716b2
+- password: xxxxxxxxxx
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 29 : bbc96594b4e001778eee9975372716b2</strong></p> <h3 id="level-29---level-30"> <a href="#level-29---level-30" class="anchor-head"></a> Level 29 -&gt; Level 30 </h3> <p>After looking at the <em>README</em> file, it looks like there’s an another branch out there, so I ran <em>git branch -a</em> to list all branches. Changing to branch <em>dev</em> and running git show to show all commits.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git branch <span class="nt">-a</span>
<span class="k">*</span> dev
  master
  production
  remotes/origin/HEAD -&gt; origin/master
  remotes/origin/dev
  remotes/origin/master
  remotes/origin/sploits-dev

<span class="nv">$ </span>git checkout dev
Branch dev <span class="nb">set </span>up to track remote branch dev from origin.
Switched to a new branch <span class="s1">'dev'</span>


<span class="nv">$ </span>git show
commit bc833286fca18a3948aec989f7025e23ffc16c07
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Thu May 7 20:14:52 2020 +0200

    add data needed <span class="k">for </span>development

diff <span class="nt">--git</span> a/README.md b/README.md
index 1af21d3..39b87a8 100644
<span class="nt">---</span> a/README.md
+++ b/README.md
@@ <span class="nt">-4</span>,5 +4,5 @@ Some notes <span class="k">for </span>bandit30 of bandit.
 <span class="c">## credentials</span>
 
 - username: bandit30
<span class="nt">--</span> password: &lt;no passwords <span class="k">in </span>production!&gt;
+- password: 5b90576bedb2cc04c86a9e924ce42faf
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 30 : 5b90576bedb2cc04c86a9e924ce42faf</strong></p> <h3 id="level-30---level-31"> <a href="#level-30---level-31" class="anchor-head"></a> Level 30 -&gt; Level 31 </h3> <p>This time <em>README</em> file and log file has nothing to show, so I tried to see <em>tagging</em></p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git tag 
secret
<span class="nv">$ </span>git show secret 
47e603bb428404d265f59c42920d81e5
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 31 : 47e603bb428404d265f59c42920d81e5</strong></p> <h3 id="level-31---level-32"> <a href="#level-31---level-32" class="anchor-head"></a> Level 31 -&gt; Level 32 </h3> <p>Details are in README file.</p> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>andit31@bandit:/tmp/coffee32/repo<span class="nv">$ </span>git add key.txt <span class="nt">-f</span>
bandit31@bandit:/tmp/coffee32/repo<span class="nv">$ </span>git commit <span class="nt">-a</span> <span class="nt">-m</span> <span class="s1">'key file'</span>
<span class="o">[</span>master 6f5fbec] key file
 1 file changed, 1 insertion<span class="o">(</span>+<span class="o">)</span>
 create mode 100644 key.txt
bandit31@bandit:/tmp/coffee32/repo<span class="nv">$ </span>git push
Could not create directory <span class="s1">'/home/bandit31/.ssh'</span><span class="nb">.</span>
The authenticity of host <span class="s1">'localhost (127.0.0.1)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit31-git@localhost'</span>s password: 
Counting objects: 3, <span class="k">done</span><span class="nb">.</span>
Delta compression using up to 2 threads.
Compressing objects: 100% <span class="o">(</span>2/2<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
Writing objects: 100% <span class="o">(</span>3/3<span class="o">)</span>, 320 bytes | 0 bytes/s, <span class="k">done</span><span class="nb">.</span>
Total 3 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>
remote: <span class="c">### Attempting to validate files... ####</span>
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
remote: Well <span class="k">done</span><span class="o">!</span> Here is the password <span class="k">for </span>the next level:
remote: 56a9bf19c63d650ce78e6ec0354ee45e
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
To ssh://localhost/home/bandit31-git/repo
 <span class="o">!</span> <span class="o">[</span>remote rejected] master -&gt; master <span class="o">(</span>pre-receive hook declined<span class="o">)</span>
error: failed to push some refs to <span class="s1">'ssh://bandit31-git@localhost/home/bandit31-git/repo'</span>
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 32 : 56a9bf19c63d650ce78e6ec0354ee45e</strong></p> <h3 id="level-32---level-33"> <a href="#level-32---level-33" class="anchor-head"></a> Level 32 -&gt; Level 33 </h3> <p>So after logging in, it appears like everything we type is converted to uppercase (STDIN -&gt; UPPERCASE (STDIN) -&gt; STDOUT) so typing $0 will let us type directly to /bin/bash</p> <blockquote> <p>$0 Expands to the name of the shell or shell script. This is set at shell initialization.</p> </blockquote> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WELCOME TO THE UPPERCASE SHELL
<span class="o">&gt;&gt;</span> <span class="nv">$0</span>
<span class="nb">whoami
</span>bandit33
<span class="nb">cat</span> /etc/bandit_pass/bandit33
c9c3199ddf4121b10cf581a98d51caee
</code></pre></div></div><hr /> <p><strong>PASSWORD LEVEL 33 : c9c3199ddf4121b10cf581a98d51caee</strong></p> <h3 id="level-33"> <a href="#level-33" class="anchor-head"></a> LEVEL 33 </h3> <hr /> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bandit33@bandit:~<span class="nv">$ </span><span class="nb">cat </span>README.txt 
Congratulations on solving the last level of this game!

At this moment, there are no more levels to play <span class="k">in </span>this game. However, we are constantly working
on new levels and will most likely <span class="nb">expand </span>this game with more levels soon.
Keep an eye out <span class="k">for </span>an announcement on our usual communication channels!
In the meantime, you could play some of our other wargames.

If you have an idea <span class="k">for </span>an awesome new level, please <span class="nb">let </span>us know!
</code></pre></div></div><hr /> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/Delays/" > <div class="nav-arrow">Previous</div> <span class="post-title">Delay</span> </a> <a class="post-nav-item post-nav-next" href="/Databases-Introduction/"> <div class="nav-arrow">Next</div> <span class="post-title">Databases - Introduction</span> </a> </nav> <footer class="footer"> Made by <a href="https://github.com/seifallahhomrani1" target="_blank" rel="noreferrer noopener" >Seif-Allah</a> <span class="footer_item">&copy; 2021</span> <small class="footer_copyright"> </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
