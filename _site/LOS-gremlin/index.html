<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap" rel="stylesheet"> 
<link rel="icon" href="/assets/images/favicon.ico">

<title>Lord Of SQLi : gremlin Writeup | Seif-Allah's Blog</title>

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Lord Of SQLi : gremlin Writeup | Seif-Allah’s Blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Lord Of SQLi : gremlin Writeup" />
<meta name="author" content="Seif-Allah" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="‘Lord of SQL Injection’, a site where you can learn about SQL injection vulnerabilities while capturing dungeons’" />
<meta property="og:description" content="‘Lord of SQL Injection’, a site where you can learn about SQL injection vulnerabilities while capturing dungeons’" />
<meta property="og:site_name" content="Seif-Allah’s Blog" />
<meta property="og:image" content="/assets/images/writeups/los/sql1.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-03T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/images/writeups/los/sql1.png" />
<meta property="twitter:title" content="Lord Of SQLi : gremlin Writeup" />
<script type="application/ld+json">
{"@type":"BlogPosting","image":"/assets/images/writeups/los/sql1.png","headline":"Lord Of SQLi : gremlin Writeup","dateModified":"2021-01-03T00:00:00+01:00","url":"/LOS-gremlin/","datePublished":"2021-01-03T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"/LOS-gremlin/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/cover.png"},"name":"Seif-Allah"},"author":{"@type":"Person","name":"Seif-Allah"},"description":"‘Lord of SQL Injection’, a site where you can learn about SQL injection vulnerabilities while capturing dungeons’","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
<link href="/assets/css/prism.css" rel="stylesheet">

<link href="/assets/css/theme.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body>


<!-- Begin Sidebar Navigation
================================================== -->

<div class="sidebar">    
</div>   
<div class="nav-icon">
    <div class="hamburger-bar"></div>
</div>
<div id="blackover-nav" class="blackover"></div>
<nav id="menu">
    <ul>
        <h3>Navigation</h3>
        <li><a href="/">Home</a></li>
        <li><a  href="/contact">Contact</a></li>
        <li><a href="/categories#Python">Python</a></li>
        <li><a href="/categories#Java">Java</a></li>
        <li><a href="/categories#CTF-WriteUp">CTF-WriteUp</a></li>
        <li><a href="/categories#Articles">Articles</a></li>
        <li><a href="/categories#Networking">Networking</a></li>    
        <li><a href="/categories#Databases">Databases</a></li>
        <li><a href="/categories#Django">Django</a></li>     
        <li><a href="/categories#Linux">Linux</a></li>     
    </ul>   
</nav>

<script src="assets/js/lunr.js"></script>

<style>
    
</style>

<div class="wrap-search">
    <div class="d-flex align-items-center ml-auto">
        <i class="fas fa-search show-search"></i>
        <form class="bd-search ml-3" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
            <input type="text" class="form-control bigradius text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
        </form>
    </div>
</div>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="assets/js/lunrsearchengine.js"></script>


<!-- End Sidebar Navigation
================================================== -->

<div class="site-content ">

<div class="container">

    <!-- Site Logo/Name
    ================================================== -->
   
    <a class="navbar-brand" href="/">
        <img src="/assets/images/cover.png" alt="Seif-Allah's Blog">
    </a>  
   

    <!-- Site Tag
    ================================================== -->
    

    <!-- Content
    ================================================== -->
    <div class="main-content">
        <div class="entry-header">
    <!-- Post Title -->
    <h1 class="posttitle">Lord Of SQLi : gremlin Writeup</h1>
    <!-- Author & Date  Box -->
    
    
    <div class="d-flex align-items-center mt-4">
        <div>
            
            <img class="author-thumb" src="https://www.gravatar.com/avatar/87daf283c8d29fa33059e59cf5d183bb?s=250&d=mm&r=x" alt="Seif-Allah">
            
        </div>            
        <div>
        Written by <a target="_blank" class="text-dark" href="seifallahhomrani1.social">Seif-Allah</a> on 
        <span class="post-date"><time class="post-date" datetime="2021-01-03">03 Jan 2021</time></span>           
        
        </div>            
    </div>
    
</div>

<!-- Adsense under title if enabled from _config.yml (change your pub id and slot) -->


<!-- Featured Image -->

<div class="entry-featured-image">
    
    <img class="featured-image " src="//assets/images/writeups/los/sql1.png" alt="Lord Of SQLi : gremlin Writeup">
    
</div>


<!-- Content -->
<!-- Post, Page Content
================================================== -->
<div class="article-post">
    <!-- Toc if any -->
    
    <!-- End Toc -->
    <p><br /></p>

<p><img src="/assets/images/writeups/los/sql1.png" style="  width: 100%; max-width: 600px; height: auto;" /></p>

<p><strong>Resources :</strong> <a href="/databases/2020/11/24/SQL-Injection.html">SQL INJECTION - Introduction</a></p>

<h3 id="introduction">Introduction</h3>
<p><a href="https://los.rubiya.kr/">‘Lord of SQL Injection’</a>, a site where you can learn about SQL injection vulnerabilities while capturing dungeons. 
LoS provides 49 stepwise SQLinjection challenges.
Challenges are about SQLinjection at mysql, sqlite, mssql, mongodb, webapp what protected by WAF.</p>
<ul>
  <li>Site origin Country : Korea</li>
  <li>Language : English</li>
</ul>

<h3 id="gremlin">Gremlin</h3>
<p>Given a php code :</p>
<hr />
<pre><code class="language-php"> &lt;?php
  include "./config.php";
  login_chk();
  $db = dbconnect();
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[id])) exit("No Hack ~_~"); // do not try to attack another table, database!
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[pw])) exit("No Hack ~_~");
  $query = "select id from prob_gremlin where id='{$_GET[id]}' and pw='{$_GET[pw]}'";
  echo "&lt;hr&gt;query : &lt;strong&gt;{$query}&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;";
  $result = @mysqli_fetch_array(mysqli_query($db,$query));
  if($result['id']) solve("gremlin");
  highlight_file(__FILE__);
?&gt; 
</code></pre>
<hr />
<h3 id="explanation">Explanation</h3>

<p>-&gt; <em>Challenge preparation</em>
First of all, it includes this php file called <em>config.php</em>, then it checks if you are logged in or not. After that, it connect to the database.</p>

<p>-&gt; <em>The fun begins</em>
<a href="https://www.php.net/manual/en/function.preg-match.php">preg_match</a> is a php function that performs a regular expression match. If the provided regex found in the <em>id</em> or <em>pw</em> fields it exits with “No Hack ~_~” message?</p>

<p>-&gt; <em>REGEX explanation</em>
/prob|_|.|()/i
<strong>1st Alternative prob</strong>
prob matches the characters prob literally (case insensitive)
<strong>2nd Alternative _</strong>
_ matches the character _ literally (case insensitive)
<strong>3rd Alternative .</strong>
. matches the character . literally (case insensitive)
<strong>4th Alternative ()</strong>
( matches the character ( literally (case insensitive)
) matches the character ) literally (case insensitive)
<strong>Global pattern flags</strong>
i modifier: insensitive. Case insensitive match (ignores case of [a-zA-Z])</p>

<p>Then, with the provided <em>id</em> and <em>pw</em>, the SQL query is ready to be executed, and it is printed out using the following <em>echo</em>. 
Using the <a href="https://www.php.net/manual/en/mysqli-result.fetch-array.php">mysqli_fetch_array</a> function, which fetch a result row as an associative, a numeric array, or both.</p>

<p>Finally, it checks if the id has a value, if it has, the challenge is solved !</p>

<p>I just want to mention that the <em>id</em> and <em>pw</em> field are gonna be passed in the url like this : ?id=
If you’ve read my article mentioned above, you can solve this challenge easily by closing the id field using an apostrophe then executing a condition that returns true as a result like 1=1. 
So the final result will be : 
?id=’ OR 1=1 
Then we need to comment out the <em>pw</em> field so we insert a double dash followed by a space (Black Space = %20 : URL encoding) or a hashtag(hashtag = %23 : URL encoding )
?id=’ OR 1=1 –%20
So the final query will be  :</p>
<pre><code class="language-sql">select id from prob_gremlin where id='' OR 1=1 -- ' and pw=''
</code></pre>
<p>GREMLIN CLEAR !</p>

</div>

<!-- Rating -->


<!-- Author Box if enabled from _config.yml -->
<!-- Author Box -->




<!-- Comments if not disabled with comments: false -->
<!-- Comments
================================================== -->
 
<div class="comments">
    <button class="btn btn-dark show-comments">Load Comments</button>         
    <div id="comments">  
        <h4 class="mb-4">Comments</h4>                 
            <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'demowebsite'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
     
    <div class="clearfix"></div>              
    </div>    
</div>       


<!-- Share -->
<div class="share">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Lord Of SQLi : gremlin Writeup&url=/LOS-gremlin/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=/LOS-gremlin/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=/LOS-gremlin/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
</div>


<!-- Related Post -->
<!-- Related Posts
================================================== -->
<div class=" related-posts ">  

    
    <h2 class="text-center mb-4">Explore more like this</h2>
    
    
    <div class="d-flex justify-content-center align-items-center">
    
    <!-- Categories -->
    
    
    <a class="smoothscroll badge badge-primary text-capitalize" href="categories#CTF-WriteUp">CTF-WriteUp</a>                
    

    <!-- Tags -->  
    
    

    </div>

    
    
    
    <div class="blog-grid-container">
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="/LOS-goblin/">
                

                    
                        <img class="img-thumb" src="/assets/images/writeups/los/goblin.png" alt="Lord Of SQLi : goblin Writeup"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="/LOS-goblin/">Lord Of SQLi : goblin Writeup</a>
                
            </h2>
            <h4 class="card-text">'Lord of SQL Injection', a site where you can learn about SQL injection vulnerabilities while capturing dungeons'</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://www.gravatar.com/avatar/87daf283c8d29fa33059e59cf5d183bb?s=250&d=mm&r=x" alt="Seif-Allah">
                
                </span>
                <span class="author-meta">
                <span class="post-name"><a target="_blank" href="seifallahhomrani1.social">Seif-Allah</a></span> 
                
                <span class="post-date">05 Jan 2021</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="/THM-Chill-Hack/">
                

                    
                        <img class="img-thumb" src="/assets/images/writeups/thm/chillhack/chillhack.png" alt="TryHackMe: Chill Hack WriteUp - PART 1"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="/THM-Chill-Hack/">TryHackMe: Chill Hack WriteUp - PART 1</a>
                
            </h2>
            <h4 class="card-text">TryHackMe: WriteUp for the Chill Hack room (Level: Medium)</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://www.gravatar.com/avatar/87daf283c8d29fa33059e59cf5d183bb?s=250&d=mm&r=x" alt="Seif-Allah">
                
                </span>
                <span class="author-meta">
                <span class="post-name"><a target="_blank" href="seifallahhomrani1.social">Seif-Allah</a></span> 
                
                <span class="post-date">18 Dec 2020</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="/THM-dogcat/">
                

                    
                        <img class="img-thumb" src="/assets/images/writeups/thm/dogcat/dogcat.png" alt="TryHackMe: Dogcat WriteUp"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="/THM-dogcat/">TryHackMe: Dogcat WriteUp</a>
                
            </h2>
            <h4 class="card-text">TryHackMe: WriteUp for the 'dogcat' room (Level: Medium)</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://www.gravatar.com/avatar/87daf283c8d29fa33059e59cf5d183bb?s=250&d=mm&r=x" alt="Seif-Allah">
                
                </span>
                <span class="author-meta">
                <span class="post-name"><a target="_blank" href="seifallahhomrani1.social">Seif-Allah</a></span> 
                
                <span class="post-date">14 Nov 2020</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
                
        </div>        
</div>

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

    </div>

    
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">

                <div class="col-md-6 col-sm-12 text-center text-lg-left">
                    Copyright © 2021 Seif-Allah's Blog 
                </div>
            <div class="col-md-6 col-sm-12 text-center text-lg-right">
                Made with love by    
                <a target="_blank" href="fb.com/seifallahhomrani1">Seif-Allah</a>
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts (if you need bootstrap.js, please add it yourself. I didn't use it for performance reasons, it was not needed in this theme)
================================================== -->

<script src="/assets/js/prism.js"></script>

<script src="/assets/js/theme.js"></script>




<script id="dsq-count-scr" src="//demowebsite.disqus.com/count.js"></script>


</body>
</html>
